---
description: TypeScript coding standards for the Spark project
---

# TypeScript Coding Standards

## Never Use `any`

**Rule:** Never use the `any` type in TypeScript code for this project.

**Why:**
- Defeats the purpose of TypeScript
- Hides bugs and errors
- Makes refactoring dangerous
- Reduces code maintainability

**Instead:**
- Define proper types and interfaces
- Use union types when multiple types are acceptable
- Use generics for flexible but type-safe code
- Use `unknown` if the type is truly unknown (rare cases)

## Handling Circular Dependencies

**Problem:** When two modules import each other's types, you get a circular dependency.

**Solution:** Extract shared types to a common types file.

**Example:**

```typescript
// ❌ BAD: Circular dependency
// main.ts
import { SettingTab } from './settings';

// settings.ts  
import { MainPlugin } from './main';  // Circular!

// ✅ GOOD: Shared types file
// types/index.ts
export interface IMainPlugin { ... }
export interface ISettings { ... }

// main.ts
import { IMainPlugin } from './types';

// settings.ts
import { IMainPlugin } from './types';
```

## Type Organization

**All types live in `src/types/` directory, organized by domain:**

1. **Core Types:** `src/types/index.ts` - Plugin settings, main interfaces
2. **Domain Types:** `src/types/command-palette.ts`, `src/types/chat.ts`, etc. - Feature-specific types
3. **Shared Types:** Put cross-feature types in appropriate domain file or `index.ts`
4. **Import Pattern:** Always import from `../types/` or `../types/domain-name`

**Examples:**
```typescript
// ✅ GOOD: Organized by domain
src/types/
  ├── index.ts              // SparkSettings, ISparkPlugin
  ├── command-palette.ts    // PaletteItem, TriggerContext
  └── chat.ts               // ChatMessage, ChatSession

// Import from types directory
import { ISparkPlugin } from '../types';
import { PaletteItem } from '../types/command-palette';

// ❌ BAD: Types scattered in feature directories
src/command-palette/types.ts
src/chat/types.ts
```

## Type Naming Conventions

- **Interfaces:** Prefix with `I` for clarity (e.g., `ISparkPlugin`)
- **Types:** Use PascalCase (e.g., `PaletteItem`)
- **Enums:** Use PascalCase (e.g., `NotificationType`)
- **Generic Parameters:** Single uppercase letter or descriptive name (e.g., `T` or `TItem`)

## Examples from Spark Plugin

### ✅ Correct Pattern

```typescript
// src/types/index.ts
import { Plugin } from 'obsidian';

export interface SparkSettings {
    enablePalette: boolean;
    enableChat: boolean;
}

export interface ISparkPlugin extends Plugin {
    settings: SparkSettings;
    loadSettings(): Promise<void>;
    saveSettings(): Promise<void>;
}

// src/main.ts
import { ISparkPlugin, SparkSettings } from './types';

export default class SparkPlugin extends Plugin implements ISparkPlugin {
    settings: SparkSettings;
    // ...
}

// src/settings.ts
import { ISparkPlugin } from './types';

export class SparkSettingTab {
    plugin: ISparkPlugin;  // Typed, not 'any'
    // ...
}
```

### ❌ Anti-Patterns to Avoid

```typescript
// Never do this:
plugin: any;  // ❌ No!

// Or this:
function process(data: any) { }  // ❌ No!

// Or this:
const result = response as any;  // ❌ No!
```

## When Types Seem Difficult

If you find yourself wanting to use `any`:

1. **Stop and think:** What is the actual type?
2. **Check the library docs:** Most libraries export their types
3. **Use TypeScript utilities:** `Partial<T>`, `Pick<T>`, `Omit<T>`, etc.
4. **Create a union:** `string | number` is better than `any`
5. **Ask for help:** Don't compromise type safety

## Type Safety Benefits

- **Catch bugs at compile time**, not runtime
- **Better IDE support** with autocomplete and refactoring
- **Self-documenting code** through type definitions
- **Safer refactoring** with confidence
- **Team collaboration** with clear contracts

---

**Remember:** Types are documentation, safety nets, and productivity tools. Use them properly!

## Related Rules

For Obsidian-specific guidelines (DOM APIs, file handling, settings UI), see:
- [obsidian-plugin-guidelines.mdc](obsidian-plugin-guidelines.mdc)
